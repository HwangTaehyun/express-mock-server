{"version":3,"file":"control.js","names":["router","express","Router","isLogEnabled","config","controlApi","sourcesParser","post","req","res","console","log","green","body","forEach","record","switchRecord","status","StatusCodes","ACCEPTED","end","resetMap"],"sources":["../../lib/api/control.js"],"sourcesContent":["import express from 'express';\nimport { StatusCodes } from 'http-status-codes';\nimport config from '../config';\n\nconst router = express.Router({});\nconst { isLogEnabled } = config;\n\nexport const controlApi = (sourcesParser) => {\n  router.post('/set', (req, res) => {\n    if (isLogEnabled) {\n      console.log('API set new values'.green);\n    }\n\n    req.body.forEach((record) => {\n      // console.log('new record is >');\n      // console.log(JSON.stringify(record, null, \"  \"));\n      // console.log('< new record is');\n      sourcesParser.switchRecord(record);\n    });\n\n    res.status(StatusCodes.ACCEPTED).end();\n  });\n\n  router.post('/reset', (req, res) => {\n    if (isLogEnabled) {\n      console.log('API Reset'.green);\n    }\n\n    sourcesParser.resetMap();\n\n    res.status(StatusCodes.ACCEPTED).end();\n  });\n\n  return router;\n};\n"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;;;AAEA,MAAMA,MAAM,GAAGC,gBAAA,CAAQC,MAAR,CAAe,EAAf,CAAf;;AACA,MAAM;EAAEC;AAAF,IAAmBC,eAAzB;;AAEO,MAAMC,UAAU,GAAIC,aAAD,IAAmB;EAC3CN,MAAM,CAACO,IAAP,CAAY,MAAZ,EAAoB,CAACC,GAAD,EAAMC,GAAN,KAAc;IAChC,IAAIN,YAAJ,EAAkB;MAChBO,OAAO,CAACC,GAAR,CAAY,qBAAqBC,KAAjC;IACD;;IAEDJ,GAAG,CAACK,IAAJ,CAASC,OAAT,CAAkBC,MAAD,IAAY;MAC3B;MACA;MACA;MACAT,aAAa,CAACU,YAAd,CAA2BD,MAA3B;IACD,CALD;IAOAN,GAAG,CAACQ,MAAJ,CAAWC,4BAAA,CAAYC,QAAvB,EAAiCC,GAAjC;EACD,CAbD;EAeApB,MAAM,CAACO,IAAP,CAAY,QAAZ,EAAsB,CAACC,GAAD,EAAMC,GAAN,KAAc;IAClC,IAAIN,YAAJ,EAAkB;MAChBO,OAAO,CAACC,GAAR,CAAY,YAAYC,KAAxB;IACD;;IAEDN,aAAa,CAACe,QAAd;IAEAZ,GAAG,CAACQ,MAAJ,CAAWC,4BAAA,CAAYC,QAAvB,EAAiCC,GAAjC;EACD,CARD;EAUA,OAAOpB,MAAP;AACD,CA3BM"}